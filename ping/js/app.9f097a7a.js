(function(){var t={8013:function(t,e,n){"use strict";var o=n(9242),a=n(3396);const r={id:"app"};function s(t,e,n,o,s,i){const l=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(l)])}var i={name:"App"},l=n(89);const u=(0,l.Z)(i,[["render",s]]);var c=u,d=n(7657),p=n(678);const b={class:"home-view"};function h(t,e,n,o,r,s){const i=(0,a.up)("z-ping");return(0,a.wg)(),(0,a.iD)("div",b,[(0,a.Wm)(i)])}var f=n(7139);const m=t=>((0,a.dD)("data-v-17d7985e"),t=t(),(0,a.Cn)(),t),g={class:"container"},w=m((()=>(0,a._)("footer",null,[(0,a.Uk)(" Copyright © CSZnet | Website: "),(0,a._)("a",{target:"_blank",href:"https://www.csz.net"},"www.csz.net")],-1)));function v(t,e,n,r,s,i){const l=(0,a.up)("el-input"),u=(0,a.up)("el-col"),c=(0,a.up)("el-button"),d=(0,a.up)("el-row"),p=(0,a.up)("el-table-column"),b=(0,a.up)("el-table"),h=(0,a.up)("TopRight"),m=(0,a.up)("el-icon"),v=(0,a.up)("el-link"),k=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",g,[(0,a.Wm)(d,{class:"input-row",gutter:20,type:"flex",justify:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{xs:24,sm:18,md:12,lg:12,xl:12},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:s.input,"onUpdate:modelValue":e[0]||(e[0]=t=>s.input=t),placeholder:"请输入域名或者IP",onKeydown:(0,o.D2)((0,o.iM)(i.connectWebSocket,["ctrl"]),["enter"])},null,8,["modelValue","onKeydown"])])),_:1}),(0,a.Wm)(u,{xs:24,sm:6,md:2,lg:2,xl:2,class:"send-button-col"},{default:(0,a.w5)((()=>[s.buttonDisabled?((0,a.wg)(),(0,a.j4)(c,{key:1,onClick:i.disconnectWebSocket,type:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Stop ")])),_:1},8,["onClick"])):((0,a.wg)(),(0,a.j4)(c,{key:0,onClick:i.connectWebSocket,disabled:!s.input},{default:(0,a.w5)((()=>[(0,a.Uk)(" Send ")])),_:1},8,["onClick","disabled"]))])),_:1})])),_:1}),(0,a.wy)(((0,a.wg)(),(0,a.j4)(b,{data:Object.values(i.groupedData),height:"500",border:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"expand"},{default:(0,a.w5)((t=>[(0,a.Wm)(b,{data:t.row,height:"300",border:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{prop:"id",label:"序号",sortable:""}),(0,a.Wm)(p,{prop:"Host",label:"主机",sortable:""}),(0,a.Wm)(p,{prop:"Loss",label:"丢包率",sortable:""}),(0,a.Wm)(p,{prop:"Last",label:"最后一次",sortable:""}),(0,a.Wm)(p,{prop:"Avg",label:"平均",sortable:""}),(0,a.Wm)(p,{prop:"Best",label:"最佳",sortable:""}),(0,a.Wm)(p,{prop:"Wrst",label:"最差",sortable:""}),(0,a.Wm)(p,{prop:"StDev",label:"标准差",sortable:""})])),_:2},1032,["data"])])),_:1}),(0,a.Wm)(p,{label:"Provide"},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(t[0].clientName)+" ",1),(0,a.Wm)(v,{type:"primary",href:t[0].clientUrl,target:"_blank",class:"client-url-link"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h)])),_:1})])),_:2},1032,["href"])])),_:1}),(0,a.Wm)(p,{label:"Send",prop:"length",sortable:""},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(t.length),1)])),_:1}),(0,a.Wm)(p,{label:"Loss",prop:"averageLoss",sortable:""},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(i.calculateAverageLoss(t))+"% ",1)])),_:1}),(0,a.Wm)(p,{label:"Best",prop:"minBest",sortable:""},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(i.calculateMinBest(t)),1)])),_:1}),(0,a.Wm)(p,{label:"Wrst",prop:"maxWrst",sortable:""},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(i.calculateMaxWrst(t)),1)])),_:1}),(0,a.Wm)(p,{label:"Host",prop:"frequentHost",sortable:""},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,f.zw)(i.mostFrequentHost(t)),1)])),_:1})])),_:1},8,["data"])),[[k,s.loading]])]),w],64)}n(7658);var k=n(8082),W=n.n(k),y={data(){return{input:"",socket:null,tableData:[],buttonDisabled:!1,activePanels:[],loading:!1}},computed:{groupedData(){return this.tableData.reduce(((t,e)=>(t[e.uuid]||(t[e.uuid]=[]),t[e.uuid].push(e),t)),{})},formattedGroupedData(){let t=[];for(const e in this.groupedData){let n=this.groupedData[e];t.push({data:n,length:n.length})}return t}},methods:{isDomainOrIP(t){const e=/^(?=.{1,255})(?:(?!-)[A-Za-z0-9-]{1,63}(?<!-)\.?)+(?:[A-Za-z]{2,6})$/,n=/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;return e.test(t)||n.test(t)},onDataReceived(t){let e=this.groupedData.find((e=>e.clientName===t.clientName));e||(e={clientName:t.clientName,clientUrl:t.clientUrl,data:[]},this.groupedData.push(e)),e.data.push(t),this.groupedData=[...this.groupedData]},generateToken(t){const e=W().SHA256(`${t}bbbb`);return e.toString(W().enc.Hex)},async createRequestMessage(t,e){const n=Math.floor(Date.now()/1e3).toString(),o=this.generateToken(n);return{time:n,type:t,content:e,token:o}},async connectWebSocket(){if(this.isDomainOrIP(this.input)&&this.input)if(this.socket&&this.socket.readyState===WebSocket.OPEN){const t=await this.createRequestMessage("ping",this.input);this.socket.send(JSON.stringify(t)),this.buttonDisabled=!0}else this.socket=new WebSocket("ws://192.168.88.9:8080/ws"),this.socket.addEventListener("open",(async()=>{const t=await this.createRequestMessage("ping",this.input);this.socket.send(JSON.stringify(t)),this.buttonDisabled=!0})),this.tableData=[],this.loading=!0,this.socket.addEventListener("message",(t=>{try{const e=JSON.parse(t.data);this.tableData.push(e),this.loading=!1;const n=this.tableData.reduce(((t,e)=>(t[e.uuid]=(t[e.uuid]||0)+1,t)),{}),o=Object.values(n).every((t=>t>=10));o&&this.disconnectWebSocket()}catch(e){console.error("Received invalid JSON:",t.data)}this.loading=!1})),this.socket.addEventListener("error",(()=>{this.$message.error("服务端握手失败"),this.buttonDisabled=!1}));else this.$message.error("请输入域名或者IP")},disconnectWebSocket(){this.socket&&(this.socket.close(),this.socket=null,this.buttonDisabled=!1,this.loading=!1)},mostFrequentHost(t){const e=t.reduce(((t,e)=>(t[e.Host]||(t[e.Host]=0),t[e.Host]++,t)),{});let n=0,o="";for(const a in e)e[a]>n&&(n=e[a],o=a);return o},togglePanel(t){const e=this.activePanels.indexOf(t);-1===e?this.activePanels.push(t):this.activePanels.splice(e,1)},calculateAverageLoss(t){const e=t.reduce(((t,e)=>t+e.Loss),0);return(e/t.length).toFixed(2)},calculateMinBest(t){return Math.min(...t.map((t=>t.Best)))},calculateMaxWrst(t){return Math.max(...t.map((t=>t.Wrst)))}}};const D=(0,l.Z)(y,[["render",v],["__scopeId","data-v-17d7985e"]]);var _=D,S={components:{ZPing:_},name:"HomeView"};const O=(0,l.Z)(S,[["render",h]]);var x=O;const P=[{path:"/",name:"Home",component:x,meta:{title:"Ping - CSZnet"}}],j=(0,p.p7)({history:(0,p.r5)(),routes:P});var M=j,z=n(65),H=(0,z.MT)({state:{},mutations:{},actions:{},modules:{}}),U=n(9579),C=(n(4415),n(2748));const L=(0,o.ri)(c),N=(0,d.Bg)();L.use(N),L.use(H).use(M).use(U.Z);for(const[Z,T]of Object.entries(C))L.component(Z,T);L.mount("#app"),M.afterEach((t=>{t.meta&&t.meta.title?document.title=t.meta.title:document.title="CSZnet"}))},2480:function(){}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,o,a,r){if(!o){var s=1/0;for(c=0;c<t.length;c++){o=t[c][0],a=t[c][1],r=t[c][2];for(var i=!0,l=0;l<o.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[l])}))?o.splice(l--,1):(i=!1,r<s&&(s=r));if(i){t.splice(c--,1);var u=a();void 0!==u&&(e=u)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,a,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,r,s=o[0],i=o[1],l=o[2],u=0;if(s.some((function(e){return 0!==t[e]}))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(l)var c=l(n)}for(e&&e(o);u<s.length;u++)r=s[u],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},o=self["webpackChunkzping_web"]=self["webpackChunkzping_web"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(8013)}));o=n.O(o)})();
//# sourceMappingURL=app.9f097a7a.js.map